<div class="member-management-container">
  <div class="header-section">
    <h1>Member Management</h1>
    <p>Manage all community members and their activities</p>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-grid">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">people</mat-icon>
          <div class="stat-details">
            <h3>{{ totalMembers }}</h3>
            <p>Total Members</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">check_circle</mat-icon>
          <div class="stat-details">
            <h3>{{ activeMembers }}</h3>
            <p>Active Members</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">pending</mat-icon>
          <div class="stat-details">
            <h3>{{ pendingMembers }}</h3>
            <p>Pending Approval</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon">account_balance</mat-icon>
          <div class="stat-details">
            <h3>{{ totalActiveLoans }}</h3>
            <p>Active Loans</p>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Filters Section -->
  <mat-card class="filters-section">
    <mat-card-content>
      <div class="filter-controls">
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Search Members</mat-label>
          <input matInput [(ngModel)]="searchTerm" (input)="applyFilters()" placeholder="Search by name, email, or unit">
          <mat-icon matSuffix>search</mat-icon>
        </mat-form-field>

        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Status</mat-label>
          <mat-select [(value)]="statusFilter" (selectionChange)="applyFilters()">
            <mat-option value="all">All Status</mat-option>
            <mat-option value="active">Active</mat-option>
            <mat-option value="inactive">Inactive</mat-option>
            <mat-option value="pending">Pending</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Community Unit</mat-label>
          <mat-select [(value)]="unitFilter" (selectionChange)="applyFilters()">
            <mat-option value="all">All Units</mat-option>
            <mat-option *ngFor="let unit of getUniqueUnits()" [value]="unit">{{ unit }}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Members Table -->
  <mat-card class="members-table-section">
    <mat-card-header>
      <mat-card-title>Community Members</mat-card-title>
      <span class="results-count">{{ filteredMembers.length }} members found</span>
    </mat-card-header>

    <mat-card-content>
      <table mat-table [dataSource]="filteredMembers" class="full-width">
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>Member Name</th>
          <td mat-cell *matCellDef="let member">
            <div class="member-name">
              <mat-icon>person</mat-icon>
              <div class="member-details">
                <strong>{{ member.name }}</strong>
                <span class="email">{{ member.email }}</span>
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Contact Column -->
        <ng-container matColumnDef="contact">
          <th mat-header-cell *matHeaderCellDef>Contact</th>
          <td mat-cell *matCellDef="let member">
            <div class="contact-info">
              <span>{{ member.phone }}</span>
            </div>
          </td>
        </ng-container>

        <!-- Unit Column -->
        <ng-container matColumnDef="unit">
          <th mat-header-cell *matHeaderCellDef>Unit</th>
          <td mat-cell *matCellDef="let member">
            <span class="unit-badge">{{ member.communityUnit }}</span>
          </td>
        </ng-container>

        <!-- Join Date Column -->
        <ng-container matColumnDef="joinDate">
          <th mat-header-cell *matHeaderCellDef>Join Date</th>
          <td mat-cell *matCellDef="let member">
            {{ member.joinDate | date:'mediumDate' }}
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef>Status</th>
          <td mat-cell *matCellDef="let member">
            <span [class]="getStatusClass(member.status)">
              {{ getStatusTranslation(member.status) }}
            </span>
          </td>
        </ng-container>

        <!-- Loans Column -->
        <ng-container matColumnDef="loans">
          <th mat-header-cell *matHeaderCellDef>Loans</th>
          <td mat-cell *matCellDef="let member">
            <div class="loan-info">
              <span class="total-loans">{{ member.totalLoans }} total</span>
              <span class="active-loans" *ngIf="member.activeLoans > 0">
                ({{ member.activeLoans }} active)
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let member">
            <div class="action-buttons">
              <button mat-icon-button color="primary" [matTooltip]="'View ' + member.name" (click)="viewMemberDetails(member)">
                <mat-icon>visibility</mat-icon>
              </button>
              
              <button mat-icon-button color="accent" [matTooltip]="'Edit ' + member.name" (click)="editMember(member)">
                <mat-icon>edit</mat-icon>
              </button>

              <button mat-icon-button color="info" [matTooltip]="'Payment History - ' + member.name" (click)="viewPaymentHistory(member)">
                <mat-icon>receipt</mat-icon>
              </button>

              <button *ngIf="member.status === 'pending'" 
                      mat-icon-button 
                      color="primary" 
                      [matTooltip]="'Approve ' + member.name"
                      (click)="approveMember(member)">
                <mat-icon>check_circle</mat-icon>
              </button>
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <!-- Empty State -->
      <div *ngIf="filteredMembers.length === 0" class="empty-state">
        <mat-icon>group_off</mat-icon>
        <h3>No members found</h3>
        <p>Try adjusting your search criteria</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>